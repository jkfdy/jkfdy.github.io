---
title: 面向新手的Git教程：搭建个人 Git 托管服务器
date: 2025-07-31 15:00:00 +0800
categories: [Git]
tags: [Git, GitHub]
---

Git 的优点之一就是分布式，因此我们可以很方便的把 Git 仓库从一个服务器迁移到另一个服务器。我们需要做的只是在本地仓库添加新服务器地址，然后向新服务器`push`。

> 也是因此，我在很多年前就把个人笔记放到 Git 上。这样的好处是数据在自己手里，即便 Git 托管服务提供商倒闭了，我只需要花费1分钟就能把仓库切换到另一家服务商那里了。

## 盘点一下这些年用过的 Git 托管商

GitHub 就不提了，大家都知道。先说一个大家可能没听过的，叫 GitCafe，国内公司的，网站的 logo 是一杯咖啡，于 2012 年上线，那时候做 Git 托管这个赛道的厂家很少，在国内 GitCafe 比 GitHub 的访问速度快，当时也是风头无两。直到 2016 年的时候 GitCafe 被后来者 Coding（后面也会提到）收购，被收购后就停了个人业务，后面慢慢的就消失了。

GitEE，大家估计都听过这个，因为现在别家基本上都倒闭了，剩 GitEE 还活着。但是 GitEE 早起的使用体验非常不好，如果项目里有稍微大一点的文件，用户需要手动执行下面的命令来修改 HTTP post 缓冲区的大小：

```bash
git config --global http.postBuffer 524288000
```

用别人家的服务（GitLab除外）是不需要这样设置的，也是这个原因让我对 GitEE 的印象很不好，被恶心到几次后就是尽量避免用这个产品了，当然现在的 GitEE 已经没这个问题了。

Coding，终于讲到 Coding了！2014 年上线的，当时给人的感觉就是眼前一亮，界面很摩登，使用体验也很棒，也不限制免费用户可以创建的仓库数。当时 GitHub 免费用户是不能创建私有仓库的，所以我从那时起，需要用 Git 托管的地方就直接首选 Coding 了。

Coding 上面的活动也很多，一开始还搞了一个“冒泡”社区，类似于微博，只不过用户都是程序员。别人点赞了你的冒泡会有积分，积分可以兑换 Coding 的周边，对了 Coding 的 logo 是洋葱猴，其中有个周边就是洋葱猴抱枕。

![洋葱猴抱枕](/assets/img/posts/2025/coding-pillow.jpg)

另一个大事就是 Coding 收购 GitCafe，当时 Coding 的风头不比现在的 GitEE 差。可能是像我这样白嫖的人太多，付费用户太少，后来慢慢的“冒泡”社区关闭了，Coding 也慢慢冷清了。

再后来 Coding 被腾讯收购了，我心想腾讯多有钱，这样我能一直用下去了。直到今年看到 Coding 下线的公告。

![Coding 下线公告](/assets/img/posts/2025/coding-off.png)

有点遗憾，不过还是非常感谢 Coding 让免费用户白嫖了这么久，竟然已经有十一年了。

虽然说腾讯云还提供了云原生构建代替 Coding，但我暂时先不尝试了，决定试一下把仓库放到自己的地盘。

## Git 支持的协议

Git 支持四种协议：本地协议、HTTP 协议、SSH 协议和 Git 协议。在这四个协议中比较常用的是 HTTP 协议和 SSH 协议，基本上每个第三方 Git 托管服务器上都会为每个仓库提供一个 HTTP 协议地址和一个 SSH 协议地址。

另外的本地协议不常用的原因是我们很少需要在同一台电脑上为同一个项目创建两个仓库。可能唯一会用到这种协议的就是共享文件系统了，把网络中的共享文件系统挂载到本地文件系统中，这样就能使用本地协议来访问共享文件系统中的仓库了。不过相对于其他协议来说，配置共享文件系统也很复杂，所以用的不多。

还有一个 Git 协议，虽然这个协议是所有 Git 协议中传输速度最快的，但由于这个协议缺乏授权机制，所以只要别人知道仓库地址，就能无差别的访问你的仓库，显然不是我们想要的。

剩下的 HTTP 协议和 SSH 协议最常用，在这两种协议中，我个人比较偏好使用 SSH 协议，因为只要我们把自己电脑的 SSH 公钥上传到服务器上，在自己的电脑上就可以永久的免密访问服务器上的仓库了，SSH 会帮我们处理用户认证那些事情。

如果是 HTTP 协议，就做不到免密了，虽然说现在操作系统和浏览器都能帮我们自动生成并记忆复杂密码，但因为 HTTP 的密码有时候需要修改，修改后再执行 Git 操作还需要重新输入新密码，这就比 SSH 麻烦很多了。

SSH 还有一个优于 HTTP 的地方是一般服务器上都默认支持 SSH，但是要支持 HTTP 协议，你就需要再另外部署 Web 服务器（比如Apache、Nginx），然后再为 Git 配置对应操作的 CGI 程序，还需要设置用户连接 HTTP 服务时使用的用户名和密码。而如果使用 SSH 协议，什么都不需要做了，直接就能用！

## Git 使用 SSH 协议示例

我们现在假设家里有一台支持 SSH 登录的服务器（此服务器绑定了域名`example.com`）（现在一些中高端的路由器已经支持 SSH 登录），远程用户的用户名为 bob，它上面连接着一块移动硬盘，硬盘的挂载目录是`/mnt/data`，我们在移动硬盘的根目录上创建了名为`git`的文件夹用于存放 Git 仓库。

在我们的电脑上有一个项目名为 Notebook。

1. 在服务器上创建仓库。

```bash
# 远程连接服务器
ssh bob@example.com
# 进入存放仓库的目录
cd /mnt/data/git
# 为新仓库创建文件夹
mkdir Notebook.git
# 初始化裸仓库
cd Notebook.git
git init --bare --shared
```

2. 修改本地项目的远程地址

```bash
# 进入 Notebook 所在目录
cd path/to/Notebook
# 删除旧的远程地址
git remote remove origin
# 添加新的远程地址
git remote add origin bob@example.com:/mnt/data/git/Notebook.git
```

3. 把本地仓库推送到远程服务器上

```bash
git push -u origin main
```
